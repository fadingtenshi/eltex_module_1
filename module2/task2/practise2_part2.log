
1) journalctl -b -S "$(uptime -s)" -U "$(date -d "$(uptime -s) +6.0sec" --iso-8601=seconds)"
ar 12 19:59:40 localhost kernel: Linux version 6.8.0-55-generic (buildd@lcy02-amd64-095) (x86_64-linux-gnu-gcc-13 (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0, GNU ld (GNU Binutils for Ubuntu) 2.>
Mar 12 19:59:40 localhost kernel: Command line: BOOT_IMAGE=/vmlinuz-6.8.0-55-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro
Mar 12 19:59:40 localhost kernel: KERNEL supported cpus:
Mar 12 19:59:40 localhost kernel:   Intel GenuineIntel
Mar 12 19:59:40 localhost kernel:   AMD AuthenticAMD
Mar 12 19:59:40 localhost kernel:   Hygon HygonGenuine
Mar 12 19:59:40 localhost kernel:   Centaur CentaurHauls
Mar 12 19:59:40 localhost kernel:   zhaoxin   Shanghai  
Mar 12 19:59:40 localhost kernel: BIOS-provided physical RAM map:
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x0000000000000000-0x000000000009fbff] usable
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x000000000009fc00-0x000000000009ffff] reserved
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x00000000000f0000-0x00000000000fffff] reserved
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x0000000000100000-0x00000000bffd9fff] usable
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x00000000bffda000-0x00000000bfffffff] reserved
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x00000000feffc000-0x00000000feffffff] reserved
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x00000000fffc0000-0x00000000ffffffff] reserved
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x0000000100000000-0x000000013fffffff] usable
Mar 12 19:59:40 localhost kernel: BIOS-e820: [mem 0x000000fd00000000-0x000000ffffffffff] reserved
Mar 12 19:59:40 localhost kernel: NX (Execute Disable) protection: active

2) find /var/log -name "auth.log" -exec awk '{print $3, substr($0, index($0, $6))}' {} + | sed 's/\[[0-9]*\]//' | sort
su: opened for user user3(uid=1003) by root(uid=0)
su: root on pts/0
sudo: TTY=pts/0 ; PWD=/root ; USER=root ; COMMAND=/usr/bin/tee /usr/local/bin/suid_dmesg
systemd-logind: 1345 of user root.

3) find /var/log -name "auth.log" -exec awk '{print $3, substr($0, index($0, $6))}' {} + | sed 's/\[[0-9]*\]//' | sort | uniq -c | sort -rn
796 CRON: opened for user root(uid=0) by root(uid=0)
    796 CRON: closed for user root
     13 su: root on pts/0
     11 sudo: opened for user root(uid=0) by root(uid=0)
     11 sudo: closed for user root
      6 su: opened for user user1(uid=1001) by root(uid=0)
      6 su: closed for user user1
      6 sshd: opened for user root(uid=0) by root(uid=0)
      5 su: opened for user user2(uid=1002) by root(uid=0)
      5 su: closed for user user2
      2 systemd-logind: logged out. Waiting for processes to exit.

4) cat /etc/passwd | awk -F: '$7 == "/usr/sbin/nologin" {print $3, $1}' | sort -nr | while read uid user; do echo "$uid, $user, $(id -Gn $user)"; done
65534, nobody, nogroup
1003, user3, user3 newgroup
998, systemd-network, systemd-network
997, systemd-timesync, systemd-timesync
992, systemd-resolve, systemd-resolve
991, polkitd, polkitd
989, fwupd-refresh, fwupd-refresh
109, sshd, nogroup
108, usbmux, plugdev
107, landscape, landscape
105, tcpdump, tcpdump
104, uuidd, uuidd
103, syslog, syslog adm
101, messagebus, messagebus
42, _apt, nogroup
39, irc, irc
38, list, list
34, backup, backup
33, www-data, www-data
13, proxy, proxy
10, uucp, uucp
9, news, news
8, mail, mail
7, lp, lp
6, man, man
5, games, games
3, sys, sys
2, bin, bin
1, daemon, daemon

5) dmesg | grep -i 'kernel'
[    0.000000] KERNEL supported cpus:
[    0.040722] Booting paravirtualized kernel on KVM
[    0.041575] Kernel command line: BOOT_IMAGE=/vmlinuz-6.8.0-55-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro
[    0.041604] Unknown kernel command line parameters "BOOT_IMAGE=/vmlinuz-6.8.0-55-generic", will be passed to user space.
[    0.091996] Memory: 3933488K/4193760K available (22528K kernel code, 4443K rwdata, 14344K rodata, 4988K init, 4716K bss, 260012K reserved, 0K cma-reserved)
[    0.248022] DMA: preallocated 512 KiB GFP_KERNEL pool for atomic allocations
[    0.248049] DMA: preallocated 512 KiB GFP_KERNEL|GFP_DMA pool for atomic allocations
[    0.248077] DMA: preallocated 512 KiB GFP_KERNEL|GFP_DMA32 pool for atomic allocations
[    0.493879] Loaded X.509 cert 'Build time autogenerated kernel key: e0bedf6fa049a1e09bd65ebab3904f14cdd5bc68'
[    0.496935] Loaded X.509 cert 'Canonical Ltd. Kernel Module Signing: 88f752e560a1e0737e31163a466ad7b70a850c19'
[    0.661295] Loaded X.509 cert 'Build time autogenerated kernel key: e0bedf6fa049a1e09bd65ebab3904f14cdd5bc68'
[    0.681596] Freeing unused kernel image (initmem) memory: 4988K
[    0.682230] Write protecting the kernel read-only data: 38912k
[    0.683185] Freeing unused kernel image (rodata/data gap) memory: 2040K
[    5.403936] systemd[1]: Listening on systemd-udevd-kernel.socket - udev Kernel Socket.
[    5.416797] systemd[1]: Mounting sys-kernel-debug.mount - Kernel Debug File System...
[    5.420783] systemd[1]: Mounting sys-kernel-tracing.mount - Kernel Trace File System...
[    5.446925] systemd[1]: Starting modprobe@configfs.service - Load Kernel Module configfs...
[    5.451565] systemd[1]: Starting modprobe@dm_mod.service - Load Kernel Module dm_mod...
[    5.455221] systemd[1]: Starting modprobe@drm.service - Load Kernel Module drm...
[    5.459155] systemd[1]: Starting modprobe@efi_pstore.service - Load Kernel Module efi_pstore...
[    5.471922] systemd[1]: Starting modprobe@fuse.service - Load Kernel Module fuse...
[    5.491237] systemd[1]: Starting modprobe@loop.service - Load Kernel Module loop...
[    5.520822] systemd[1]: Starting systemd-modules-load.service - Load Kernel Modules...
[    5.525425] systemd[1]: Starting systemd-remount-fs.service - Remount Root and Kernel File Systems...

6) wc -l /var/log/kern.log
55 /var/log/kern.log

7) awk '/Start-Date:/ {start=$0} /Commandline:/ {cmd=$0} /End-Date:/ {end=$0; printf "Commandline: %s\n%s\n%s\n\n", cmd, start, end}' /var/log/apt/history.log
ommandline: Commandline: apt-get install --reinstall apt
Start-Date: 2025-02-16  20:51:22
End-Date: 2025-02-16  20:51:24

Commandline: Commandline: apt-get install --reinstall base-files
Start-Date: 2025-02-16  20:51:26
End-Date: 2025-02-16  20:51:28

Commandline: Commandline: apt-get install --reinstall base-passwd
Start-Date: 2025-02-16  20:51:31
End-Date: 2025-02-16  20:51:32

Commandline: Commandline: apt-get install --reinstall bash
Start-Date: 2025-02-16  20:51:35
End-Date: 2025-02-16  20:51:37

Commandline: Commandline: apt-get install --reinstall bsdutils
Start-Date: 2025-02-16  20:51:39
End-Date: 2025-02-16  20:51:41
